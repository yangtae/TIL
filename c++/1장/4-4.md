### 스타크래프트 만들자 2

이번 공부는 

- 생성자 초기화 리스트
- 클래스의 const, static 변수
- 래퍼런스 타입을 리턴하는 함수
- this 포인터
- const 멤버 함수

등에 공부할 것이다



#### 생성자의 초기화 리스트

```c++
#include <iostream>

class Marine {
    int hp; 
    int coordX, coordY;
    int damage;
    bool isDead;
    
    public:
    Marine();	//기본생성자
    Marine(int x, int y); //x,y좌표에 마린 생성
    
    int attack();  //데미지 리턴
    void beAttacked(int damageEarn); //입는 데미지
    void move(int x, int y);
    
    void showStatus();
};

Marine::Marine() : hp(50), coordX(0), coordY(0), damage(5), isDead(false) {}

Marine::Marine(int x, int y) : coordX(x), coordY(y), hp(50), damage(5), isDead(false) {}

void Marine::move(int x, int y) {
    coordX = x;
    coordY = y;
}

int Marine::attack { return damage; }

void Marine::beAttacked(int damageEarn) {
    hp -= damageEarn;
    if (hp < 0) isDead = true;
}

void Marine::showStatus() {
    std::cout << "***Marine***" std::endl;
    std::cout << "Location : " << coordX << "," << coordY << std::endl;
    std::cout << "HP : " << hp << std::endl;
}

int main() {
    Marine marine1(2,3);
    Marine marine2(3,5);
    
    marine1.showStatus();
    marine2.showStatus();
}

// *** Marine *** 
// Location : ( 2 , 3 ) 
// HP : 50
// *** Marine *** 
// Location : ( 3 , 5 ) 
// HP : 50
```

코드를 하나씩 살펴보자

```c++
Marine::Marine() : hp(50), coodX(0), coordY(0), damage(5), isDead(false){}
```

함수 본체에는 아무것도 없다. 오직 위에 추가된 이상한 것들이 기존의 생성자가 했던 일과 동일한 작업을 하고 있다. 기존의 생성자는

```c++
Marine::Marine() {
	hp = 50;
    coordX = coordY = 0;
    damage = 5;
    isDead = false;
}
```

이렇게 생겼는데, 그 내부에서 하던 멤버 변수들의 초기화 작업들을 새롭게 추가한 것들이 대신해서 하고 있을 뿐이다.

위의 따라오는 것들을 초기화 리스트라고 부르며, 생성자 호출과 동시에 멤버 변수들을 초기화 해준다.

그렇다면 왜 초기화 리스트를 사용해야 되는지 의문점이 생길 수 있는데, 그 이유는

초기화 리스트를 사용한 버전의 경우 생성과 초기화를 동시에 하게 된다.

반면에 초기화 리스트를 사용하지 않는다면 생성을 먼저 하고 그 다음에 대입을 수행하게 된다

쉽게 말하면 초기화 리스트를 사용하는 것은

```c++
int a = 10;
```

이라 하는것과 같고 예전 버전의 생성자는

```c++
int a;
a = 10;
```

하는것과 동일하다. 만약에 int가 대신에 클래스 였다면 전자의 경우 복사 생성자가 호출되는데, 후자의 경우 디폴트 생성자가 호출된 뒤 대입이 수행된다는 말이다.

딱 보아도 후자가 조금 더 하는 작업이 많다. 따라서 초기화 리스트를 사용하는 것이 조금 더 효율적인 작업이라는 것이다. 뿐만 아니라 **경험상 반드시 생성과 동시에 초기화 되어야 하는 것들이 몇 가지 있다. 대표적으로 래퍼런스와 상수가 있다.**

앞서 공부한 것에 따르면 상수롸 레퍼런스들은 모두 생성과 동시에 초기화가 되어야 한다.

따라서 클래스 내부에 레퍼런스 변수나 상수를 넣고 싶다면 이들을 생성자에서 무조건 초기화 리스트를 사용해서 초기화 시켜주어야만 한다.



```c++
#include <iostream>

class Marine {
	int hp;
    int coordX, coordY;
    bool isDead;
    
    const int defaultDamage;
    
    public:
    Marine(); //기본 생성자
    Marine(int x, int y);
    
    int attack();
    void beAttacked(int damageEarn); //입는 데미지
    void move(int x, int y);
    
    void showStatus();
};

Marine::Marine() : hp(50), coordX(0), coordY(0), defaultDamage(5), isDead(false) {}

Marine::Marine(int x, int y) : hp(50), coordX(x), coordY(y), defaultDamage(5), isDead(false) {}

void Marine::move(int x, int y) {
    coordX = x;
    coordY = y;
}

int Marine::attack() { return defaultDamage;}

void Marine::beAttacked(int damageEarn) {
    hp -= damageEarn;
    if (hp < 0) isDead = true;
}

void Marine::showStatus() {
    std::cout << " *** Marine *** " << std::endl;
  	std::cout << " Location : ( " << coordX << " , " << coordY << " ) " << std::endl;
  std::cout << " HP : " << hp << std::endl;
}

int main() {
  Marine marine1(2, 3);
  Marine marine2(3, 5);

  marine1.showStatus();
  marine2.showStatus();

  std::cout << std::endl << "마린 1 이 마린 2 를 공격! " << std::endl;
  marine2.beAttacked(marine1.attack());

  marine1.showStatus();
  marine2.showStatus();
}

 //*** Marine *** 
 //Location : ( 2 , 3 ) 
 //HP : 50
 //*** Marine *** 
 //Location : ( 3 , 5 ) 
 //HP : 50

//마린 1 이 마린 2 를 공격! 
// *** Marine *** 
// Location : ( 2 , 3 ) 
// HP : 50
// *** Marine *** 
// Location : ( 3 , 5 ) 
// HP : 45
```

위 마린 클래스는 프로그머들의 실수로 마린의 공격력이 이상하게 변하는 것을 막기 위해 기본 공격력이라는 상수 멤버를 도입해서, 고정시키고 마음 편하게 프로그래밍 할 수 있도록 하였다. 따라서 이를 위해 생성자에서 초기화 리스트를 도입해서

```c++
Marine::Marine(int x, int y) : hp(50), coordX(x), coordY(y), defaultDamage(5), isDead(false) {}
```

와 같이 defaultDamage를 생성과 동시에 초기화 할 수 있도록 하였다. 따라서 상수인 defaultDamage를 5로 초기화 할 수 있고 이 값은 영원히 바뀌지 않는다
